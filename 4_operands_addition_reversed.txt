# to edit: do an evaluation every {eval_interval} iterations
eval_interval = 1000
eval_iters = 1
always_save_checkpoint = True


wandb_log = True # override via command line if you like
wandb_project = 'addition'

# to edit: wandb run name
wandb_run_name = 'comparison'

# baby GPT model :)
n_layer = 6
n_head = 6
n_embd = 384
dropout = 0.2

# to edit: 'plain' or 'reverse' or 'algo_reasoning'
data_format='plain'
operator=','
dataset = 'bal'
batch_size = 512
block_size = 16 # context of up to 256 previous characters

# to edit: 'scratch' or 'resume', whether train from scratch or resume from a saved checkpoint
init_from = 'scratch'
iter_num = 0
# to edit: the checkpoint from which to resume training
ckpt_path_name = 'ckpt_iter_19000_acc.pt'

# to edit: whether the result is reversed
reverse_c = False
eval_addition = True

analysis = False

# to edit: num of digits in each operand
num_digit = 4

# to edit: maximum number of output tokens (including '$')
max_new_tokens = 2

drop_leading_digit = False

# whether need zero‚Äêpadding
zero_pad = False

# ===== Learning Rate Policy ===== #
learning_rate = 1e-3

# to edit: the number of training iterations
max_iters = 15000
lr_decay_iters = 15000 # make equal to max_iters usually (300000)

beta1 = 0.9
beta2 = 0.98
warmup_iters = 100

# ===== Device ===== #
device='cuda:0'

# to edit: the output directory
out_dir = '/content/drive/MyDrive/comparison/result'

# to edit: training data
train_data_path = '/content/drive/MyDrive/comparison/data/train.txt'

# to edit: whether do evaluation on training data to see if the model is simply memorizing
eval_addition_train = True
start_train = "/content/drive/MyDrive/comparison/data/train.txt"

# to edit: validation data
val_data_path = '/content/drive/MyDrive/comparison/data/val.txt'

# to edit: test data; start is just the test file. It can be either without gold (thus gold by computing) or with gold (thus gold by reading)
test_file_path = '/content/drive/MyDrive/comparison/data/test.txt'

# to edit: "compute_gold" or "read_gold_as_str"; read or compute groundtruth in evaluation data
mode = "read_gold_as_str"

# to edit: whether to do more frequenly evaluations in early stages
more_early_eval1 = False
early_eval_interval1 = 25
early_eval_border1 = 1000

more_early_eval2 = False
early_eval_interval2 = 5
early_eval_border2 = 750

# to edit: whether do mutual information measurement between diffrent pairs of digits (include input-output and output-output)
mi_measurement = False

# (optional) data for additional statistical measurement
stats_measurement_data_file_path = '/content/drive/MyDrive/addition/data/4_operands_0_to_999_output_wo_leading_digit/4_operand_addition_stats_measurement_data_reversed.txt'

early_mi_measure_border = 200000
early_mi_measure_interval = 5000
final_mi_measure_interval = 5000
